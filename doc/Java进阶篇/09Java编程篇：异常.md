# Java编程篇：创建与销毁对象

**关于作者**

>郭孝星，程序员，吉他手，主要从事Android平台基础架构方面的工作，欢迎交流技术方面的问题，可以去我的[Github](https://github.com/guoxiaoxing)提issue或者发邮件至guoxiaoxingse@163.com与我交流。


## 异常实践

1 异常应该只用于异常的情况下，它们永远不应该用在正常的控制流中，因为这不仅会模糊程序的意图，增加测试的难度，而且对于现代JVM而言，还会
带来性能的损失。

2 对于可以恢复的情况，我们可以抛出受检的异常，以便调用者捕获到这个异常后，做适当的恢复。对于程序运行错误，则使用运行时异常。但是要避免使用不必要的
异常，这回增加调用者的负担，必要的时候可以进行状态判断，针对不同的状态做异常情况的处理，而不是不假思索的就将异常抛出去。

3 优先去使用标准的异常，这会是你的API更加易于学习和使用，常见的标准异常：

- IllegalArgumentException：非法参数
- IllegalStateException：非法状态
- NullPointerException：空指针
- IndexOutOfBoundException：下标参数值越界
- ConcurrentModificationException：在禁止并发修改的情况下，检测到对象的并发修改
- UnsupportedOperationException：对象不支持用户请求的方法

4 如果异常从底层层层抛出到高层，这种情况下我们要对异常进行合理的转译，将异常重新包装成上层可以理解的异常，这种转译也被称为异常链。

5 对于抛出的异常，我们要提供完整的失败信息，例如IndexOutOfBoundException，我们要提供数组的上下边界、当前索引等信息，方便调用者捕获错误。

6 保持失败的原子性，也就是说当异常发生时，我们期望这个过程里的对象能够保持调用之前的状态，以便下一次可以继续进行正常的调用，通常而言，我们有四种方法：

- 设计一个不可变对象，这显然是最简单的方法。
- 如果对象时可变的，我们在操作对象之前，就要去检查参数的有效性，提前抛出异常，这样就可以不去改变对象的状态，使得可能失败的部分在改变对象状态之前发生。
- 编写恢复代码，由它来拦截操作过程中发生的失败，用来将对象回滚到操作之前的状态。
- 复制一个临时对象，在这个临时对象上进行操作，操作成功后再用这个临时对象代替原来的对象。

7 不要随意去忽略异常，在catch()方法中，如果没有任何处理，就会导致程序在遇到错误的情况下悄然执行，并在将来某个时间节点莫名其妙的失败，所以我们应该在
catch()方法中完成对异常的处理，要么就直接抛出异常，让程序快速失败。